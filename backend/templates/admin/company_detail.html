<!-- file: backend/templates/admin/company_detail.html -->
{% extends "base.html" %}

{% block title %}Unternehmen {{ company.name }} — CRM{% endblock %}

{% block content %}
<h1 class="mb-3">Unternehmen: {{ company.name }}</h1>

<div class="mb-3">
  <strong>VAT:</strong> {{ company.vat_number or '—' }}<br>
  <strong>Land:</strong> {{ company.country or '—' }}<br>
  <strong>Stadt:</strong> {{ company.city or '—' }}<br>
  <strong>Adresse:</strong> {{ company.address or '—' }}<br>
  <strong>PLZ:</strong> {{ company.postal_code or '—' }}<br>
  <strong>Benutzer:</strong> {{ company.user.email if company.user else '—' }}
</div>

<h4>B2B-Prüfungen</h4>
{% if b2b_checks %}
  <div class="table-responsive">
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>Datum</th>
          <th>USt-IdNr.</th>
          <th>Land</th>
          <th>Gültige USt-IdNr.</th>
          <th>Im Register</th>
          <th>Sanktioniert</th>
          <th>Bewertung</th>
        </tr>
      </thead>
      <tbody>
        {% for r in b2b_checks %}
          <tr>
            <td>{{ r.created_at }}</td>
            <td>{{ r.vat_number }}</td>
            <td>{{ r.country }}</td>
            <td>{% if r.is_valid_vat %}✅{% else %}❌{% endif %}</td>
            <td>{% if r.is_company_found %}✅{% else %}❌{% endif %}</td>
            <td>{% if r.is_sanctioned %}⚠️{% else %}✅{% endif %}</td>
            <td>{{ r.score }}</td>
          </tr>
          {% if r.screenshot_path %}
            <tr>
              <td colspan="7">
                <strong>Website-Snapshot:</strong>
                <a href="{{ r.screenshot_path }}" target="_blank">
                  <img src="{{ r.screenshot_path }}" alt="Snapshot" style="max-height:200px;">
                </a>
              </td>
            </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <p>Noch keine B2B-Prüfungen.</p>
{% endif %}

<a href="{{ url_for('admin.companies_list') }}" class="btn btn-secondary mt-3">Zurück zur Liste</a>
{% endblock %}